define(function(t,e,n){"use strict";function i(t,e){function n(t){var e,n,i=0,o=t.length,r=[],u=0;for(""===l[0]&&(u=1,r.push(a[0])),n=0;s>n;n++)if(l[n]){if(e=+l[n]+i,r.push(t.slice(i,e)),e>o)break;r.push(a[n+u]),i=e}return r.join("")}var i=[];if(!e)return t;var l=e.split(/[^\d]+/g),a=e.split(/\d+/g),s=l.length;""===a[0]&&a.shift(),""===a[a.length-1]&&a.pop();var o=new RegExp("(\\"+a.join("|\\")+")","g");t=t.replace(o,"");var r,u=t.length,c=l.reduce(function(t,e){return+t+ +e}),h=Math.ceil(u/c),d=0;for(r=0;h>r;r++)i.push(n(t.slice(d,d+c))),d+=c;return i.join("")}function l(t){t.addEventListener("input",function(){var t=this.getAttribute("data-format"),e=(this.getAttribute("coord"),this.value),n=i(e,t),l=this.getAttribute("oldval")||"",a=this.selectionStart,s=0;o.indexOf("linux; u")>-1&&n.length>l.length&&a++,o.indexOf("iphone os 6")>-1&&0==a&&a++,n===l&&" "===n.slice(a,a+1)?(e=e.slice(0,a-1>=0?a-1:0)+e.slice(a),n=i(e,t),s=1):" "===n.slice(a-1,a)&&(n.length>l.length?s=-1:n.length<l.length&&(s=1)),this.value=n;var r,u=this;r=o.indexOf("iphone os 6")>-1?function(){var t,e=0;u.selectionEnd+1>=n.length?e=Math.abs(l.length-n.length):(t=n.slice(a).length-l.slice(a).length)>0?(s=0,s=" "===n.slice(a,a+1)?-1:0,e=1):e=Math.abs(l.slice(0,a).length-n.slice(0,a).length),n.replace(/\s/g,"")===l.slice(1).replace(/\s/g,"")&&(s=1),u.selectionStart=a+e-s,u.selectionEnd=u.selectionStart}:function(){u.selectionStart=a+Math.abs(l.slice(0,a).length-n.slice(0,a).length)-s,u.selectionEnd=u.selectionStart},o.indexOf("linux; u")>-1||o.indexOf("iphone os 6")>-1?setTimeout(function(){r()},0):r(),this.setAttribute("oldval",this.value)},!1)}function a(t){t.addEventListener("inputFormatter",function(){var t=this.value,e=this.getAttribute("data-format");this.value=i(t,e)})}var s={},o=navigator.userAgent.toLowerCase();s.listen=function(t){t&&!t.length&&(t=[t]),t=t||document.querySelectorAll("input[data-format]"),[].forEach.call(t,function(t){t[0]&&t[0].addEventListener&&(t=t[0]),t._InputFormatBinded||(t.value&&(t.value=i(t.value,t.getAttribute("data-format"))),t._customKeyboard?a(t):l(t),t._InputFormatBinded=!0)})},"complete"===document.readyState?s.listen():document.addEventListener("DOMContentLoaded",function(){s.listen()},!1);var r=s;n.exports=r});